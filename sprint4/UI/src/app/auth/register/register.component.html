<div class="container auth-container">
  <div class="row justify-content-center">
    <div class="col-lg-8 auth-form">
      <h3>Customer registration</h3>
      <form [formGroup]="register" (ngSubmit)="onSubmit()" data-test="register-form">
        <div class="row">
          <div class="col-md-6">
            <div class="form-group mb-3">
              <label for="first_name" class="form-label">First name</label>
              <input formControlName="first_name"
                id="first_name"
                data-test="first-name"
                class="form-control"
                [ngClass]="{ 'is-invalid': submitted && f['first_name'].errors }"
                type="text"
                placeholder="Your first name *"
                value=""/>
            </div>
            @if (f['first_name'].invalid && submitted) {
              <div data-test="first-name-error"
                class="alert alert-danger">
                @if (f['first_name'].errors?.['required']) {
                  <div>
                    First name is required.
                  </div>
                }
              </div>
            }
          </div>
          <div class="col-md-6">
            <div class="form-group mb-3">
              <label for="last_name" class="form-label">Last name</label>
              <input formControlName="last_name"
                id="last_name"
                data-test="last-name"
                class="form-control"
                [ngClass]="{ 'is-invalid': submitted && f['last_name'].errors }" type="text"
                placeholder="Your last name *"
                value=""/>
            </div>
            @if (f['last_name'].invalid && submitted) {
              <div data-test="last-name-error"
                class="alert alert-danger">
                @if (f['last_name'].errors?.['required']) {
                  <div>
                    Last name is required.
                  </div>
                }
              </div>
            }
          </div>

          <div class="form-group mb-3">
            <label for="dob" class="form-label">Date of birth</label>
            <input
              formControlName="dob"
              id="dob"
              data-test="dob"
              class="form-control"
              type="text"
              placeholder="YYYY-MM-DD"
              [ngClass]="{ 'is-invalid': submitted && f['dob'].errors }"
            />
            @if (f['dob'].invalid && submitted) {
              <div data-test="dob-error"
                class="alert alert-danger mt-3">
                @if (f['dob'].errors?.['invalidDate']) {
                  <div>
                    Please enter a valid date in YYYY-MM-DD format.
                  </div>
                }
                @if (f['dob'].errors?.['required']) {
                  <div>
                    Date of Birth is required.
                  </div>
                }
              </div>
            }
          </div>

          <div class="form-group mb-3">
            <label for="address" class="form-label">Address</label>
            <input formControlName="address"
              id="address"
              data-test="address"
              class="form-control"
              [ngClass]="{ 'is-invalid': submitted && f['address'].errors }" type="text"
              placeholder="Your address *"
              value=""/>
            @if (f['address'].invalid && submitted) {
              <div data-test="address-error"
                class="alert alert-danger mt-3">
                @if (f['address'].errors?.['required']) {
                  <div>
                    Address is required.
                  </div>
                }
              </div>
            }
          </div>

          <div class="col-md-4">
            <div class="form-group mb-3">
              <label for="postcode" class="form-label">Postcode</label>
              <input formControlName="postcode"
                id="postcode"
                data-test="postcode"
                class="form-control"
                [ngClass]="{ 'is-invalid': submitted && f['postcode'].errors }" type="text"
                placeholder="Your postcode *"
                value=""/>
            </div>
            @if (f['postcode'].invalid && submitted) {
              <div data-test="postcode-error"
                class="alert alert-danger">
                @if (f['postcode'].errors?.['required']) {
                  <div>
                    Postcode is required.
                  </div>
                }
                @if (f['postcode'].errors?.['pattern']) {
                  <div>
                    Only 5 numbers are allowed.
                  </div>
                }
              </div>
            }
          </div>
          <div class="col-md-8">
            <div class="form-group mb-3">
              <label for="city" class="form-label">City</label>
              <input formControlName="city"
                id="city"
                data-test="city"
                class="form-control"
                [ngClass]="{ 'is-invalid': submitted && f['city'].errors }" type="text"
                placeholder="Your city *"
                value=""/>
            </div>
            @if (f['city'].invalid && submitted) {
              <div data-test="city-error"
                class="alert alert-danger">
                @if (f['city'].errors?.['required']) {
                  <div>
                    City is required.
                  </div>
                }
              </div>
            }
          </div>
          <div class="col-md-6">
            <div class="form-group mb-3">
              <label for="state" class="form-label">State</label>
              <input formControlName="state"
                id="state"
                data-test="state"
                class="form-control"
                [ngClass]="{ 'is-invalid': submitted && f['state'].errors }" type="text"
                placeholder="Your state *"
                value=""/>
            </div>
            @if (f['state'].invalid && submitted) {
              <div data-test="state-error"
                class="alert alert-danger">
                @if (f['state'].errors?.['required']) {
                  <div>
                    State is required.
                  </div>
                }
              </div>
            }
          </div>
          <div class="col-md-6">
            <div class="form-group mb-3">
              <label for="country" class="form-label">Country</label>
              <select id="country"
                data-test="country"
                formControlName="country"
                [ngClass]="{ 'is-invalid': submitted && f['country'].errors }" class="form-select">
                <option value="" disabled selected hidden>Select your country *</option>
                @for (country of countries; track country) {
                  <option value="{{country.code}}">{{country.name}}</option>
                }
              </select>
            </div>
            @if (f['country'].invalid && submitted) {
              <div data-test="country-error"
                class="alert alert-danger">
                @if (f['country'].errors?.['required']) {
                  <div>
                    Country is required.
                  </div>
                }
              </div>
            }
          </div>
          <div class="form-group mb-3">
            <label for="phone" class="form-label">Phone</label>
            <input formControlName="phone"
              id="phone"
              data-test="phone"
              class="form-control"
              [ngClass]="{ 'is-invalid': submitted && f['phone'].errors }" type="text"
              placeholder="Your phone *"
              value=""/>
            @if (f['phone'].invalid && submitted) {
              <div data-test="phone-error"
                class="alert alert-danger mt-3">
                @if (f['phone'].errors?.['required']) {
                  <div>
                    Phone is required.
                  </div>
                }
                @if (f['phone'].errors?.['pattern']) {
                  <div>
                    Only numbers are allowed.
                  </div>
                }
              </div>
            }
          </div>
          <div class="form-group mb-3">
            <label for="email" class="form-label">E-mail address</label>
            <input formControlName="email"
              id="email"
              data-test="email"
              class="form-control"
              [ngClass]="{ 'is-invalid': submitted && f['email'].errors }" type="text"
              placeholder="Your e-mail *"
              value=""/>
            @if (f['email'].invalid && submitted) {
              <div data-test="email-error"
                class="alert alert-danger mt-3">
                @if (f['email'].errors?.['required']) {
                  <div>
                    E-mail is required.
                  </div>
                }
                @if (f['email'].errors?.['pattern']) {
                  <div>
                    E-mail format is invalid.
                  </div>
                }
              </div>
            }
          </div>
          <div class="form-group mb-3">
            <label for="password" class="form-label">Password</label>
            <input formControlName="password"
              id="password"
              data-test="password"
              class="form-control"
              [ngClass]="{ 'is-invalid': submitted && f['password'].errors }" type="password"
              placeholder="Your password *"
              value=""/>
            @if (f['password'].invalid && submitted) {
              <div data-test="password-error"
                class="alert alert-danger mt-3">
                @if (f['password'].errors?.['required']) {
                  <div>
                    Password is required.
                  </div>
                }
                @if (f['password'].errors?.['minlength']) {
                  <div>
                    Password must be minimal 6 characters long.
                  </div>
                }
                @if (f['password'].errors?.['maxlength']) {
                  <div>
                    Password can not be more than 40 characters long.
                  </div>
                }
              </div>
            }
          </div>
          <button type="submit" data-test="register-submit" class="btnSubmit mb-3">Register</button>
          @if (error) {
            <div data-test="register-error" class="alert alert-danger">
              <div>
                <div class="help-block">{{error}}</div>
              </div>
            </div>
          }
        </div>
      </form>
    </div>
  </div>
</div>
